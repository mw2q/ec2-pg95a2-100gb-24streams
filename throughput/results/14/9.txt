BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%blush%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2730090244.28063
 ALGERIA                   |   1997 | 4674596678.16067
 ALGERIA                   |   1996 |  4684635604.2998
 ALGERIA                   |   1995 | 4673425909.39736
 ALGERIA                   |   1994 | 4646219412.06174
 ALGERIA                   |   1993 | 4659972420.89409
 ALGERIA                   |   1992 | 4689594767.35034
 ARGENTINA                 |   1998 | 2709948235.66121
 ARGENTINA                 |   1997 |  4656552021.9402
 ARGENTINA                 |   1996 | 4664068878.60444
 ARGENTINA                 |   1995 | 4659841625.02976
 ARGENTINA                 |   1994 | 4648185188.42756
 ARGENTINA                 |   1993 | 4626337450.94316
 ARGENTINA                 |   1992 | 4649672162.93549
 BRAZIL                    |   1998 | 2727955380.04864
 BRAZIL                    |   1997 | 4675507748.54138
 BRAZIL                    |   1996 | 4695905404.98417
 BRAZIL                    |   1995 |  4685590880.7192
 BRAZIL                    |   1994 | 4655202158.91671
 BRAZIL                    |   1993 | 4656522081.23431
 BRAZIL                    |   1992 | 4694409939.76283
 CANADA                    |   1998 | 2764831174.23725
 CANADA                    |   1997 | 4697168463.42644
 CANADA                    |   1996 | 4712545634.27188
 CANADA                    |   1995 | 4679883401.27821
 CANADA                    |   1994 | 4699553528.23448
 CANADA                    |   1993 | 4684358058.84407
 CANADA                    |   1992 | 4697463047.03782
 CHINA                     |   1998 | 2725573872.18302
 CHINA                     |   1997 | 4657742396.25573
 CHINA                     |   1996 |  4669128928.6288
 CHINA                     |   1995 | 4692401851.18694
 CHINA                     |   1994 | 4672567042.23338
 CHINA                     |   1993 | 4647343755.64678
 CHINA                     |   1992 |  4658742411.2066
 EGYPT                     |   1998 | 2753155007.82346
 EGYPT                     |   1997 | 4689775626.64621
 EGYPT                     |   1996 | 4707330979.36927
 EGYPT                     |   1995 | 4693806907.89464
 EGYPT                     |   1994 | 4673849248.61729
 EGYPT                     |   1993 | 4673789027.56453
 EGYPT                     |   1992 | 4697168954.33382
 ETHIOPIA                  |   1998 | 2765248498.39493
 ETHIOPIA                  |   1997 | 4706228653.65985
 ETHIOPIA                  |   1996 | 4697524048.72753
 ETHIOPIA                  |   1995 | 4674704091.51532
 ETHIOPIA                  |   1994 | 4722846127.69975
 ETHIOPIA                  |   1993 | 4705865228.54305
 ETHIOPIA                  |   1992 | 4702444950.33204
 FRANCE                    |   1998 | 2736880451.67534
 FRANCE                    |   1997 | 4657520680.40111
 FRANCE                    |   1996 | 4697394216.98337
 FRANCE                    |   1995 | 4646739992.73035
 FRANCE                    |   1994 | 4678592201.88399
 FRANCE                    |   1993 | 4679166180.86909
 FRANCE                    |   1992 | 4685160761.30329
 GERMANY                   |   1998 | 2752598957.01571
 GERMANY                   |   1997 | 4677283165.83219
 GERMANY                   |   1996 | 4689084551.24118
 GERMANY                   |   1995 | 4689259234.33371
 GERMANY                   |   1994 | 4670665267.06537
 GERMANY                   |   1993 | 4704450683.30852
 GERMANY                   |   1992 | 4690727841.09387
 INDIA                     |   1998 | 2737396914.78654
 INDIA                     |   1997 |  4647262263.0834
 INDIA                     |   1996 | 4690652937.52868
 INDIA                     |   1995 | 4664096951.20289
 INDIA                     |   1994 | 4690200733.75612
 INDIA                     |   1993 | 4668668236.55316
 INDIA                     |   1992 | 4689510710.40422
 INDONESIA                 |   1998 | 2713400737.30169
 INDONESIA                 |   1997 | 4611559494.60532
 INDONESIA                 |   1996 | 4612690104.32557
 INDONESIA                 |   1995 | 4605766607.03115
 INDONESIA                 |   1994 | 4605091766.53174
 INDONESIA                 |   1993 | 4592298075.85851
 INDONESIA                 |   1992 |  4570838483.2288
 IRAN                      |   1998 | 2711829358.05469
 IRAN                      |   1997 | 4638308353.47402
 IRAN                      |   1996 | 4606812706.68089
 IRAN                      |   1995 | 4616158713.03888
 IRAN                      |   1994 | 4643523947.51626
 IRAN                      |   1993 | 4645809985.11188
 IRAN                      |   1992 | 4642730347.06981
 IRAQ                      |   1998 | 2721789093.67686
 IRAQ                      |   1997 | 4638410506.01652
 IRAQ                      |   1996 |  4673927605.7699
 IRAQ                      |   1995 | 4611676497.87089
 IRAQ                      |   1994 | 4649177766.68842
 IRAQ                      |   1993 | 4638947017.01982
 IRAQ                      |   1992 | 4659836198.35605
 JAPAN                     |   1998 | 2722459810.44601
 JAPAN                     |   1997 | 4619240903.85701
 JAPAN                     |   1996 | 4663690578.52399
 JAPAN                     |   1995 | 4655679287.37006
 JAPAN                     |   1994 | 4628838401.13048
 JAPAN                     |   1993 | 4619190024.55331
 JAPAN                     |   1992 | 4627054575.49501
 JORDAN                    |   1998 | 2715481051.96667
 JORDAN                    |   1997 | 4620983800.96194
 JORDAN                    |   1996 | 4668450633.47654
 JORDAN                    |   1995 | 4622865480.57595
 JORDAN                    |   1994 | 4640505213.50001
 JORDAN                    |   1993 | 4648133806.10935
 JORDAN                    |   1992 | 4652770875.77368
 KENYA                     |   1998 | 2719515718.64889
 KENYA                     |   1997 |  4604702691.5608
 KENYA                     |   1996 | 4647396013.93103
 KENYA                     |   1995 | 4618730865.07488
 KENYA                     |   1994 | 4634108645.15686
 KENYA                     |   1993 | 4615186888.95912
 KENYA                     |   1992 | 4608841653.19919
 MOROCCO                   |   1998 | 2742888770.92423
 MOROCCO                   |   1997 | 4687003593.42451
 MOROCCO                   |   1996 | 4691175832.75229
 MOROCCO                   |   1995 |  4667333852.7695
 MOROCCO                   |   1994 | 4670222249.98343
 MOROCCO                   |   1993 |  4687468247.0615
 MOROCCO                   |   1992 | 4700232034.70836
 MOZAMBIQUE                |   1998 | 2718841195.04277
 MOZAMBIQUE                |   1997 | 4661453905.44326
 MOZAMBIQUE                |   1996 | 4662073045.41832
 MOZAMBIQUE                |   1995 | 4669480456.80304
 MOZAMBIQUE                |   1994 | 4648563540.55815
 MOZAMBIQUE                |   1993 | 4648103625.05067
 MOZAMBIQUE                |   1992 | 4662758804.99637
 PERU                      |   1998 | 2715678053.63382
 PERU                      |   1997 | 4657727045.78659
 PERU                      |   1996 | 4650187704.15666
 PERU                      |   1995 | 4651351133.58915
 PERU                      |   1994 | 4643858402.04027
 PERU                      |   1993 |  4655452455.1849
 PERU                      |   1992 | 4677226944.66793
 ROMANIA                   |   1998 | 2752836407.99429
 ROMANIA                   |   1997 | 4693241095.77638
 ROMANIA                   |   1996 | 4700777641.53872
 ROMANIA                   |   1995 | 4686540959.11468
 ROMANIA                   |   1994 | 4676852630.89311
 ROMANIA                   |   1993 |  4709793041.9996
 ROMANIA                   |   1992 | 4683928939.11776
 RUSSIA                    |   1998 | 2727642594.22601
 RUSSIA                    |   1997 | 4652395691.88994
 RUSSIA                    |   1996 | 4651195264.25902
 RUSSIA                    |   1995 | 4611440396.74773
 RUSSIA                    |   1994 | 4624581343.62497
 RUSSIA                    |   1993 | 4656961393.86595
 RUSSIA                    |   1992 | 4626004819.87868
 SAUDI ARABIA              |   1998 | 2719161805.18616
 SAUDI ARABIA              |   1997 | 4642629034.47479
 SAUDI ARABIA              |   1996 | 4650935408.65306
 SAUDI ARABIA              |   1995 | 4660087534.65519
 SAUDI ARABIA              |   1994 | 4655849703.43289
 SAUDI ARABIA              |   1993 | 4646831052.23954
 SAUDI ARABIA              |   1992 | 4647391698.89988
 UNITED KINGDOM            |   1998 | 2724423478.28908
 UNITED KINGDOM            |   1997 | 4676212659.20167
 UNITED KINGDOM            |   1996 | 4695624442.12203
 UNITED KINGDOM            |   1995 | 4663823652.49217
 UNITED KINGDOM            |   1994 | 4684171549.59664
 UNITED KINGDOM            |   1993 | 4662604997.46266
 UNITED KINGDOM            |   1992 | 4675470033.61147
 UNITED STATES             |   1998 | 2729894669.49158
 UNITED STATES             |   1997 | 4685351636.04926
 UNITED STATES             |   1996 | 4701179400.93853
 UNITED STATES             |   1995 | 4664169691.52308
 UNITED STATES             |   1994 | 4698178396.99898
 UNITED STATES             |   1993 | 4715926535.67668
 UNITED STATES             |   1992 | 4692555204.73575
 VIETNAM                   |   1998 | 2739655561.22903
 VIETNAM                   |   1997 | 4658844750.34649
 VIETNAM                   |   1996 | 4664055134.89046
 VIETNAM                   |   1995 | 4676511271.09514
 VIETNAM                   |   1994 | 4677854790.07748
 VIETNAM                   |   1993 | 4672867416.79142
 VIETNAM                   |   1992 | 4686114842.12869
(175 rows)

COMMIT;
COMMIT
