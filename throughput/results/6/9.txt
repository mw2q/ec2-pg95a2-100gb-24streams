BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%olive%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2728676353.28027
 ALGERIA                   |   1997 | 4677553794.95388
 ALGERIA                   |   1996 | 4683846824.33741
 ALGERIA                   |   1995 | 4664502755.17413
 ALGERIA                   |   1994 | 4664284020.86726
 ALGERIA                   |   1993 | 4633803919.50138
 ALGERIA                   |   1992 | 4666595239.32742
 ARGENTINA                 |   1998 | 2692629138.44686
 ARGENTINA                 |   1997 | 4641876076.46725
 ARGENTINA                 |   1996 | 4670833454.54748
 ARGENTINA                 |   1995 | 4633316564.75518
 ARGENTINA                 |   1994 | 4630477766.45478
 ARGENTINA                 |   1993 | 4627939218.74258
 ARGENTINA                 |   1992 | 4636938514.92766
 BRAZIL                    |   1998 | 2732603549.00186
 BRAZIL                    |   1997 | 4672786563.88549
 BRAZIL                    |   1996 |  4652693271.8192
 BRAZIL                    |   1995 | 4686557193.58105
 BRAZIL                    |   1994 |  4661607532.6095
 BRAZIL                    |   1993 |  4674898024.9524
 BRAZIL                    |   1992 |  4673821816.8617
 CANADA                    |   1998 | 2725538954.02474
 CANADA                    |   1997 |  4660489684.6239
 CANADA                    |   1996 | 4653945591.09089
 CANADA                    |   1995 | 4667105443.26405
 CANADA                    |   1994 | 4646277303.92787
 CANADA                    |   1993 |  4658839801.6699
 CANADA                    |   1992 | 4678927387.68129
 CHINA                     |   1998 | 2714282259.16856
 CHINA                     |   1997 |  4653594054.6455
 CHINA                     |   1996 | 4658080312.79471
 CHINA                     |   1995 | 4660080271.32957
 CHINA                     |   1994 | 4621776899.40209
 CHINA                     |   1993 | 4661975605.34185
 CHINA                     |   1992 | 4657172280.24166
 EGYPT                     |   1998 | 2728920680.96417
 EGYPT                     |   1997 | 4658797831.15877
 EGYPT                     |   1996 | 4668627552.72746
 EGYPT                     |   1995 | 4663905264.48709
 EGYPT                     |   1994 | 4674909749.33386
 EGYPT                     |   1993 | 4676750947.24755
 EGYPT                     |   1992 | 4682755801.64865
 ETHIOPIA                  |   1998 | 2749503024.43443
 ETHIOPIA                  |   1997 |  4674689005.6959
 ETHIOPIA                  |   1996 | 4668713965.23212
 ETHIOPIA                  |   1995 | 4678130162.98814
 ETHIOPIA                  |   1994 | 4691622910.70827
 ETHIOPIA                  |   1993 | 4684728040.07484
 ETHIOPIA                  |   1992 | 4683322655.92508
 FRANCE                    |   1998 |  2747745172.7121
 FRANCE                    |   1997 | 4671730953.53441
 FRANCE                    |   1996 | 4688679166.93469
 FRANCE                    |   1995 | 4685917293.81604
 FRANCE                    |   1994 | 4677859835.13933
 FRANCE                    |   1993 | 4694581890.79761
 FRANCE                    |   1992 |  4684724623.3877
 GERMANY                   |   1998 | 2743050264.70896
 GERMANY                   |   1997 | 4674187184.72882
 GERMANY                   |   1996 | 4702504928.39884
 GERMANY                   |   1995 |  4697045903.9965
 GERMANY                   |   1994 |  4654386852.9766
 GERMANY                   |   1993 | 4704234723.03051
 GERMANY                   |   1992 | 4716636813.72121
 INDIA                     |   1998 | 2746178431.05041
 INDIA                     |   1997 | 4677645546.59999
 INDIA                     |   1996 | 4683456916.52149
 INDIA                     |   1995 | 4677330562.07255
 INDIA                     |   1994 | 4663524610.55153
 INDIA                     |   1993 | 4673848061.33362
 INDIA                     |   1992 |  4671275764.2348
 INDONESIA                 |   1998 | 2705546694.54165
 INDONESIA                 |   1997 |  4640004166.7838
 INDONESIA                 |   1996 | 4625558785.97248
 INDONESIA                 |   1995 | 4614029311.32236
 INDONESIA                 |   1994 | 4644751076.68915
 INDONESIA                 |   1993 | 4607932620.49883
 INDONESIA                 |   1992 |  4636941654.0521
 IRAN                      |   1998 |  2720222367.2712
 IRAN                      |   1997 | 4664124473.77207
 IRAN                      |   1996 | 4660643674.93696
 IRAN                      |   1995 | 4640543439.99236
 IRAN                      |   1994 | 4664231511.13974
 IRAN                      |   1993 | 4653580740.85482
 IRAN                      |   1992 | 4685678438.44525
 IRAQ                      |   1998 | 2722949654.05901
 IRAQ                      |   1997 | 4646933417.30003
 IRAQ                      |   1996 | 4686550177.06083
 IRAQ                      |   1995 | 4682672292.55276
 IRAQ                      |   1994 | 4678046651.35514
 IRAQ                      |   1993 | 4652568978.15293
 IRAQ                      |   1992 | 4672779498.22182
 JAPAN                     |   1998 | 2715468467.06119
 JAPAN                     |   1997 | 4639104321.52864
 JAPAN                     |   1996 | 4673108798.49457
 JAPAN                     |   1995 | 4665856524.36098
 JAPAN                     |   1994 | 4635018538.47994
 JAPAN                     |   1993 | 4625301643.18625
 JAPAN                     |   1992 | 4633909860.66761
 JORDAN                    |   1998 | 2708713305.54555
 JORDAN                    |   1997 | 4610838444.06989
 JORDAN                    |   1996 | 4636674325.03699
 JORDAN                    |   1995 |  4623451202.7309
 JORDAN                    |   1994 | 4648658588.79751
 JORDAN                    |   1993 | 4642114390.72049
 JORDAN                    |   1992 | 4665589893.04478
 KENYA                     |   1998 | 2709441233.42471
 KENYA                     |   1997 | 4623562680.35288
 KENYA                     |   1996 | 4655505504.87352
 KENYA                     |   1995 | 4630099059.70097
 KENYA                     |   1994 | 4637878586.30688
 KENYA                     |   1993 | 4629171436.70008
 KENYA                     |   1992 | 4643648592.32328
 MOROCCO                   |   1998 |   2740491302.057
 MOROCCO                   |   1997 | 4713474823.40855
 MOROCCO                   |   1996 | 4692855473.34037
 MOROCCO                   |   1995 | 4661349895.70108
 MOROCCO                   |   1994 | 4679249797.80852
 MOROCCO                   |   1993 | 4680978978.19825
 MOROCCO                   |   1992 | 4673576412.55586
 MOZAMBIQUE                |   1998 | 2736381597.92591
 MOZAMBIQUE                |   1997 | 4684606540.42328
 MOZAMBIQUE                |   1996 | 4674575887.62659
 MOZAMBIQUE                |   1995 | 4676733995.99859
 MOZAMBIQUE                |   1994 |  4656936792.4781
 MOZAMBIQUE                |   1993 | 4659690250.79327
 MOZAMBIQUE                |   1992 | 4658765135.78632
 PERU                      |   1998 | 2700483285.69307
 PERU                      |   1997 | 4637705375.48681
 PERU                      |   1996 | 4669791982.85582
 PERU                      |   1995 | 4628287778.75907
 PERU                      |   1994 | 4637567706.91018
 PERU                      |   1993 | 4613368803.25027
 PERU                      |   1992 | 4645249963.00001
 ROMANIA                   |   1998 | 2747077910.98341
 ROMANIA                   |   1997 | 4672721727.06743
 ROMANIA                   |   1996 | 4690276094.13461
 ROMANIA                   |   1995 |  4678129776.3952
 ROMANIA                   |   1994 | 4673068428.98537
 ROMANIA                   |   1993 | 4661237518.82301
 ROMANIA                   |   1992 | 4685880297.71329
 RUSSIA                    |   1998 |  2711848725.9323
 RUSSIA                    |   1997 | 4624825651.35346
 RUSSIA                    |   1996 |  4636650106.2254
 RUSSIA                    |   1995 | 4640781902.42807
 RUSSIA                    |   1994 | 4653659686.04816
 RUSSIA                    |   1993 | 4648493152.57573
 RUSSIA                    |   1992 | 4631730089.32182
 SAUDI ARABIA              |   1998 | 2712710402.40491
 SAUDI ARABIA              |   1997 |   4663624593.443
 SAUDI ARABIA              |   1996 | 4660908721.62436
 SAUDI ARABIA              |   1995 | 4662326333.78766
 SAUDI ARABIA              |   1994 | 4649247913.04458
 SAUDI ARABIA              |   1993 | 4641945119.23778
 SAUDI ARABIA              |   1992 |  4645082274.7762
 UNITED KINGDOM            |   1998 | 2770572489.60945
 UNITED KINGDOM            |   1997 | 4764051914.60196
 UNITED KINGDOM            |   1996 | 4729201910.37516
 UNITED KINGDOM            |   1995 | 4723715592.76423
 UNITED KINGDOM            |   1994 | 4706877531.67295
 UNITED KINGDOM            |   1993 | 4703415282.94535
 UNITED KINGDOM            |   1992 | 4742554236.88378
 UNITED STATES             |   1998 | 2741811731.29536
 UNITED STATES             |   1997 | 4673451067.71758
 UNITED STATES             |   1996 | 4668516083.23449
 UNITED STATES             |   1995 | 4652560518.21684
 UNITED STATES             |   1994 | 4643522349.81515
 UNITED STATES             |   1993 | 4686762650.19612
 UNITED STATES             |   1992 | 4680760984.43665
 VIETNAM                   |   1998 |  2735348335.1011
 VIETNAM                   |   1997 | 4690401226.66438
 VIETNAM                   |   1996 | 4710417279.01316
 VIETNAM                   |   1995 | 4693986903.17243
 VIETNAM                   |   1994 | 4693105959.95855
 VIETNAM                   |   1993 |  4701224328.9394
 VIETNAM                   |   1992 | 4692647047.94413
(175 rows)

COMMIT;
COMMIT
