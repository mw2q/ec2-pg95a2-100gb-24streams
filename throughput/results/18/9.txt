BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%sienna%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2715417767.09741
 ALGERIA                   |   1997 | 4655745056.61164
 ALGERIA                   |   1996 | 4670396784.27443
 ALGERIA                   |   1995 | 4646813612.44336
 ALGERIA                   |   1994 | 4637458070.41505
 ALGERIA                   |   1993 | 4650637100.85444
 ALGERIA                   |   1992 | 4667500920.88935
 ARGENTINA                 |   1998 | 2710635590.53435
 ARGENTINA                 |   1997 | 4639141733.42615
 ARGENTINA                 |   1996 | 4654524245.46562
 ARGENTINA                 |   1995 | 4629546942.70196
 ARGENTINA                 |   1994 | 4637800353.98768
 ARGENTINA                 |   1993 | 4634999492.90315
 ARGENTINA                 |   1992 | 4657798524.79966
 BRAZIL                    |   1998 | 2744714061.77401
 BRAZIL                    |   1997 | 4669057890.89569
 BRAZIL                    |   1996 | 4685693414.59001
 BRAZIL                    |   1995 | 4684642782.39685
 BRAZIL                    |   1994 |  4663875236.7769
 BRAZIL                    |   1993 | 4678427527.58055
 BRAZIL                    |   1992 |  4668442089.9315
 CANADA                    |   1998 | 2730275175.04787
 CANADA                    |   1997 | 4670710440.22835
 CANADA                    |   1996 | 4670411006.49473
 CANADA                    |   1995 | 4681315255.78932
 CANADA                    |   1994 | 4687964093.28217
 CANADA                    |   1993 | 4666977129.25993
 CANADA                    |   1992 | 4689456414.29985
 CHINA                     |   1998 | 2728685177.68726
 CHINA                     |   1997 | 4657808230.35261
 CHINA                     |   1996 | 4679733962.88701
 CHINA                     |   1995 |  4656882931.3164
 CHINA                     |   1994 | 4661158013.12605
 CHINA                     |   1993 | 4665505985.90992
 CHINA                     |   1992 |  4683092725.0432
 EGYPT                     |   1998 | 2722238807.91472
 EGYPT                     |   1997 | 4650479415.56761
 EGYPT                     |   1996 | 4666846707.95963
 EGYPT                     |   1995 | 4662649203.27892
 EGYPT                     |   1994 | 4662663259.46641
 EGYPT                     |   1993 | 4638194855.50824
 EGYPT                     |   1992 | 4649914188.01659
 ETHIOPIA                  |   1998 | 2760749840.23633
 ETHIOPIA                  |   1997 |  4697415696.1994
 ETHIOPIA                  |   1996 |  4703990138.3136
 ETHIOPIA                  |   1995 |  4695728960.9694
 ETHIOPIA                  |   1994 | 4701153564.46307
 ETHIOPIA                  |   1993 | 4699470616.90263
 ETHIOPIA                  |   1992 | 4714258313.31102
 FRANCE                    |   1998 | 2745514110.40918
 FRANCE                    |   1997 | 4668702763.02802
 FRANCE                    |   1996 | 4689559252.54042
 FRANCE                    |   1995 | 4682307081.79042
 FRANCE                    |   1994 | 4680691821.17802
 FRANCE                    |   1993 | 4659245635.32004
 FRANCE                    |   1992 | 4697415833.66368
 GERMANY                   |   1998 | 2763263396.87125
 GERMANY                   |   1997 | 4696668644.74064
 GERMANY                   |   1996 |  4670751691.5573
 GERMANY                   |   1995 | 4684867470.86051
 GERMANY                   |   1994 | 4691138177.13946
 GERMANY                   |   1993 | 4712249786.54787
 GERMANY                   |   1992 | 4706136732.89452
 INDIA                     |   1998 | 2739631664.04641
 INDIA                     |   1997 | 4667615340.40223
 INDIA                     |   1996 | 4671384568.97887
 INDIA                     |   1995 | 4640345523.79278
 INDIA                     |   1994 | 4647036578.89787
 INDIA                     |   1993 | 4664320905.61012
 INDIA                     |   1992 | 4669129996.83903
 INDONESIA                 |   1998 | 2708918556.62488
 INDONESIA                 |   1997 | 4620584099.07122
 INDONESIA                 |   1996 | 4622880041.18679
 INDONESIA                 |   1995 | 4598142858.03357
 INDONESIA                 |   1994 | 4627930914.70956
 INDONESIA                 |   1993 | 4591767369.57125
 INDONESIA                 |   1992 | 4634341144.06747
 IRAN                      |   1998 | 2713216508.56018
 IRAN                      |   1997 | 4643736914.68818
 IRAN                      |   1996 | 4647890389.63335
 IRAN                      |   1995 | 4630883341.83458
 IRAN                      |   1994 | 4639447410.07526
 IRAN                      |   1993 | 4626164964.34882
 IRAN                      |   1992 | 4644960505.13964
 IRAQ                      |   1998 |  2724784576.6749
 IRAQ                      |   1997 | 4666603673.94774
 IRAQ                      |   1996 | 4659962131.80349
 IRAQ                      |   1995 | 4675485451.73654
 IRAQ                      |   1994 | 4652518249.81523
 IRAQ                      |   1993 | 4646406669.81051
 IRAQ                      |   1992 | 4683221895.37116
 JAPAN                     |   1998 | 2705804715.37522
 JAPAN                     |   1997 | 4628025154.37564
 JAPAN                     |   1996 | 4644166974.18708
 JAPAN                     |   1995 |  4640182141.0712
 JAPAN                     |   1994 | 4617992035.97848
 JAPAN                     |   1993 | 4629013610.68747
 JAPAN                     |   1992 | 4650060609.86674
 JORDAN                    |   1998 | 2737807681.57779
 JORDAN                    |   1997 | 4678935663.60967
 JORDAN                    |   1996 | 4689125707.52269
 JORDAN                    |   1995 | 4669410303.54408
 JORDAN                    |   1994 | 4651955183.15371
 JORDAN                    |   1993 | 4647651880.03551
 JORDAN                    |   1992 | 4652623502.02647
 KENYA                     |   1998 | 2732394732.12378
 KENYA                     |   1997 |  4633502766.3626
 KENYA                     |   1996 | 4644943851.02454
 KENYA                     |   1995 | 4630875125.80408
 KENYA                     |   1994 | 4639159865.25628
 KENYA                     |   1993 | 4633302599.25389
 KENYA                     |   1992 | 4675639385.17886
 MOROCCO                   |   1998 | 2735233001.28341
 MOROCCO                   |   1997 | 4668365567.37379
 MOROCCO                   |   1996 | 4666596380.23877
 MOROCCO                   |   1995 | 4653176026.21845
 MOROCCO                   |   1994 | 4670964817.37589
 MOROCCO                   |   1993 |  4642881144.4388
 MOROCCO                   |   1992 |  4682779577.6705
 MOZAMBIQUE                |   1998 | 2745690588.10901
 MOZAMBIQUE                |   1997 | 4689705520.76708
 MOZAMBIQUE                |   1996 | 4668560992.49907
 MOZAMBIQUE                |   1995 | 4659446061.67755
 MOZAMBIQUE                |   1994 | 4674469104.16896
 MOZAMBIQUE                |   1993 |  4660732317.1894
 MOZAMBIQUE                |   1992 | 4687236209.33798
 PERU                      |   1998 | 2680999538.48675
 PERU                      |   1997 | 4603303058.15877
 PERU                      |   1996 | 4623442472.47139
 PERU                      |   1995 | 4612066927.03411
 PERU                      |   1994 |  4596142185.8728
 PERU                      |   1993 | 4600462773.90331
 PERU                      |   1992 | 4611870763.08686
 ROMANIA                   |   1998 | 2738033895.39776
 ROMANIA                   |   1997 | 4704209969.06035
 ROMANIA                   |   1996 | 4699811334.51483
 ROMANIA                   |   1995 | 4693676262.86229
 ROMANIA                   |   1994 | 4679861472.46592
 ROMANIA                   |   1993 | 4679643963.99093
 ROMANIA                   |   1992 | 4704652503.81931
 RUSSIA                    |   1998 | 2721941907.96326
 RUSSIA                    |   1997 | 4652809395.21875
 RUSSIA                    |   1996 | 4666674431.23678
 RUSSIA                    |   1995 | 4646462773.29414
 RUSSIA                    |   1994 | 4660212886.47817
 RUSSIA                    |   1993 | 4660586815.68346
 RUSSIA                    |   1992 | 4662619230.96719
 SAUDI ARABIA              |   1998 | 2734075341.73428
 SAUDI ARABIA              |   1997 | 4640237122.33284
 SAUDI ARABIA              |   1996 | 4662732867.56193
 SAUDI ARABIA              |   1995 | 4665571982.69584
 SAUDI ARABIA              |   1994 | 4662277360.31399
 SAUDI ARABIA              |   1993 | 4670499881.36216
 SAUDI ARABIA              |   1992 |  4691781909.2443
 UNITED KINGDOM            |   1998 |  2766306314.1157
 UNITED KINGDOM            |   1997 | 4703895626.03896
 UNITED KINGDOM            |   1996 | 4729968789.98032
 UNITED KINGDOM            |   1995 | 4696724363.04244
 UNITED KINGDOM            |   1994 | 4679532535.13897
 UNITED KINGDOM            |   1993 |  4709329581.8441
 UNITED KINGDOM            |   1992 | 4733152012.24277
 UNITED STATES             |   1998 | 2734507366.91899
 UNITED STATES             |   1997 | 4656151105.32347
 UNITED STATES             |   1996 | 4685473064.79221
 UNITED STATES             |   1995 | 4672282132.34116
 UNITED STATES             |   1994 | 4677157936.53484
 UNITED STATES             |   1993 |  4677634310.6125
 UNITED STATES             |   1992 |  4684406212.8508
 VIETNAM                   |   1998 | 2752823086.21892
 VIETNAM                   |   1997 | 4691750723.33499
 VIETNAM                   |   1996 | 4699702001.86115
 VIETNAM                   |   1995 | 4711440408.78221
 VIETNAM                   |   1994 | 4696029308.52968
 VIETNAM                   |   1993 | 4713792578.25426
 VIETNAM                   |   1992 | 4699627572.82323
(175 rows)

COMMIT;
COMMIT
