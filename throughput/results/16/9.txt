BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%wheat%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2720984782.51569
 ALGERIA                   |   1997 | 4671922130.69199
 ALGERIA                   |   1996 | 4684428391.80142
 ALGERIA                   |   1995 | 4646872566.62026
 ALGERIA                   |   1994 | 4667175969.83156
 ALGERIA                   |   1993 | 4668752229.96664
 ALGERIA                   |   1992 | 4674054287.65789
 ARGENTINA                 |   1998 | 2717869756.34091
 ARGENTINA                 |   1997 | 4655650335.27365
 ARGENTINA                 |   1996 | 4668880129.43976
 ARGENTINA                 |   1995 | 4645514797.05311
 ARGENTINA                 |   1994 | 4663854597.06464
 ARGENTINA                 |   1993 | 4621031550.77725
 ARGENTINA                 |   1992 |  4651945335.8504
 BRAZIL                    |   1998 | 2734353360.26158
 BRAZIL                    |   1997 |  4664451783.0472
 BRAZIL                    |   1996 | 4698375912.04431
 BRAZIL                    |   1995 | 4673695091.69255
 BRAZIL                    |   1994 | 4662431342.36434
 BRAZIL                    |   1993 | 4665070863.55949
 BRAZIL                    |   1992 | 4647421316.07319
 CANADA                    |   1998 |  2749903568.9727
 CANADA                    |   1997 | 4667028000.82827
 CANADA                    |   1996 | 4676839722.78627
 CANADA                    |   1995 | 4699837695.51303
 CANADA                    |   1994 | 4689675901.00278
 CANADA                    |   1993 | 4677842689.91738
 CANADA                    |   1992 | 4660273657.09504
 CHINA                     |   1998 |  2750539445.1084
 CHINA                     |   1997 | 4687700121.47355
 CHINA                     |   1996 | 4713547400.39097
 CHINA                     |   1995 | 4687577422.88517
 CHINA                     |   1994 | 4671575526.83507
 CHINA                     |   1993 | 4698725973.84838
 CHINA                     |   1992 | 4679931560.99006
 EGYPT                     |   1998 | 2725191033.51863
 EGYPT                     |   1997 | 4682716528.66639
 EGYPT                     |   1996 | 4673357974.84309
 EGYPT                     |   1995 | 4672310602.34612
 EGYPT                     |   1994 | 4678915712.05105
 EGYPT                     |   1993 | 4656333776.02963
 EGYPT                     |   1992 | 4688723798.47146
 ETHIOPIA                  |   1998 | 2768890538.35027
 ETHIOPIA                  |   1997 | 4694014984.85794
 ETHIOPIA                  |   1996 | 4707006277.58091
 ETHIOPIA                  |   1995 | 4707255448.58206
 ETHIOPIA                  |   1994 | 4687887435.05887
 ETHIOPIA                  |   1993 | 4698949104.26144
 ETHIOPIA                  |   1992 | 4703303650.87656
 FRANCE                    |   1998 | 2745295177.23204
 FRANCE                    |   1997 |  4673754785.5145
 FRANCE                    |   1996 | 4687763491.23561
 FRANCE                    |   1995 | 4676613152.94431
 FRANCE                    |   1994 | 4690290970.86719
 FRANCE                    |   1993 | 4669422736.49541
 FRANCE                    |   1992 | 4681803043.70567
 GERMANY                   |   1998 | 2740638964.61602
 GERMANY                   |   1997 |  4686646499.8003
 GERMANY                   |   1996 | 4718693620.20782
 GERMANY                   |   1995 | 4658429202.23112
 GERMANY                   |   1994 | 4658654522.84978
 GERMANY                   |   1993 | 4680733657.21783
 GERMANY                   |   1992 | 4701573588.10009
 INDIA                     |   1998 | 2739667032.89794
 INDIA                     |   1997 |  4660544543.2515
 INDIA                     |   1996 | 4664355969.45542
 INDIA                     |   1995 | 4645272874.95827
 INDIA                     |   1994 | 4677642260.79549
 INDIA                     |   1993 |  4681906072.8573
 INDIA                     |   1992 | 4673628289.45728
 INDONESIA                 |   1998 | 2732485851.10535
 INDONESIA                 |   1997 | 4634780944.73521
 INDONESIA                 |   1996 | 4620817970.65839
 INDONESIA                 |   1995 | 4629920175.33299
 INDONESIA                 |   1994 | 4668333806.56474
 INDONESIA                 |   1993 | 4639028235.42038
 INDONESIA                 |   1992 | 4663306882.15738
 IRAN                      |   1998 |  2719559270.2754
 IRAN                      |   1997 | 4657808468.25024
 IRAN                      |   1996 | 4631686646.46903
 IRAN                      |   1995 | 4626480285.39617
 IRAN                      |   1994 | 4625954797.32655
 IRAN                      |   1993 | 4655446142.71144
 IRAN                      |   1992 | 4648994241.11159
 IRAQ                      |   1998 | 2725991363.18224
 IRAQ                      |   1997 | 4640083872.01197
 IRAQ                      |   1996 | 4655479002.31835
 IRAQ                      |   1995 | 4659190196.13582
 IRAQ                      |   1994 | 4654539142.32178
 IRAQ                      |   1993 | 4637239203.06117
 IRAQ                      |   1992 | 4654266032.86841
 JAPAN                     |   1998 | 2704737748.42822
 JAPAN                     |   1997 | 4594469836.73882
 JAPAN                     |   1996 |  4641587456.1922
 JAPAN                     |   1995 |  4595530072.0617
 JAPAN                     |   1994 | 4620873991.28466
 JAPAN                     |   1993 | 4607860816.36391
 JAPAN                     |   1992 | 4624303233.51439
 JORDAN                    |   1998 | 2715918039.34855
 JORDAN                    |   1997 | 4646953704.93442
 JORDAN                    |   1996 | 4664459305.43159
 JORDAN                    |   1995 |  4644764947.4892
 JORDAN                    |   1994 | 4633894865.70469
 JORDAN                    |   1993 | 4635355374.81689
 JORDAN                    |   1992 | 4649539170.60982
 KENYA                     |   1998 |  2726614050.9119
 KENYA                     |   1997 | 4638781064.50857
 KENYA                     |   1996 | 4666854493.64878
 KENYA                     |   1995 |  4653470734.8692
 KENYA                     |   1994 | 4613372677.28356
 KENYA                     |   1993 | 4620646707.04537
 KENYA                     |   1992 |  4659613076.2606
 MOROCCO                   |   1998 | 2744283100.38002
 MOROCCO                   |   1997 | 4695471525.54449
 MOROCCO                   |   1996 | 4698841384.25555
 MOROCCO                   |   1995 | 4661801772.63912
 MOROCCO                   |   1994 | 4701991157.84844
 MOROCCO                   |   1993 | 4694965095.21584
 MOROCCO                   |   1992 | 4683459583.11182
 MOZAMBIQUE                |   1998 | 2729978166.17394
 MOZAMBIQUE                |   1997 |  4687581279.4747
 MOZAMBIQUE                |   1996 | 4683722111.06907
 MOZAMBIQUE                |   1995 | 4675986323.12519
 MOZAMBIQUE                |   1994 | 4686709416.04611
 MOZAMBIQUE                |   1993 | 4666066084.14123
 MOZAMBIQUE                |   1992 | 4691867006.46482
 PERU                      |   1998 | 2716768381.18507
 PERU                      |   1997 |   4606108194.167
 PERU                      |   1996 | 4648159520.04739
 PERU                      |   1995 | 4651616395.08739
 PERU                      |   1994 |  4616476889.1976
 PERU                      |   1993 | 4640610962.56108
 PERU                      |   1992 | 4672759228.13136
 ROMANIA                   |   1998 | 2740627226.39455
 ROMANIA                   |   1997 | 4674389540.25822
 ROMANIA                   |   1996 | 4721610184.56014
 ROMANIA                   |   1995 |  4700315434.9379
 ROMANIA                   |   1994 | 4686091354.15099
 ROMANIA                   |   1993 | 4673209083.40887
 ROMANIA                   |   1992 | 4687612879.33949
 RUSSIA                    |   1998 | 2711205660.92048
 RUSSIA                    |   1997 | 4668143269.33745
 RUSSIA                    |   1996 | 4671500221.43149
 RUSSIA                    |   1995 | 4647062511.91653
 RUSSIA                    |   1994 | 4638060990.49308
 RUSSIA                    |   1993 | 4645199628.60097
 RUSSIA                    |   1992 |  4672674587.5254
 SAUDI ARABIA              |   1998 | 2707131593.00247
 SAUDI ARABIA              |   1997 | 4636518440.53946
 SAUDI ARABIA              |   1996 | 4664145006.90719
 SAUDI ARABIA              |   1995 | 4657119458.51224
 SAUDI ARABIA              |   1994 | 4654898298.51204
 SAUDI ARABIA              |   1993 | 4653080874.21049
 SAUDI ARABIA              |   1992 | 4667438489.36826
 UNITED KINGDOM            |   1998 |  2778389708.7776
 UNITED KINGDOM            |   1997 | 4721118565.67674
 UNITED KINGDOM            |   1996 | 4745468652.82069
 UNITED KINGDOM            |   1995 |  4703100240.2237
 UNITED KINGDOM            |   1994 | 4742973043.48312
 UNITED KINGDOM            |   1993 |  4705871610.8886
 UNITED KINGDOM            |   1992 | 4735148719.08465
 UNITED STATES             |   1998 | 2738418655.00079
 UNITED STATES             |   1997 | 4649229316.91619
 UNITED STATES             |   1996 | 4672011285.62212
 UNITED STATES             |   1995 |   4659145549.395
 UNITED STATES             |   1994 | 4681318051.46681
 UNITED STATES             |   1993 | 4676617780.04784
 UNITED STATES             |   1992 | 4695059939.81302
 VIETNAM                   |   1998 | 2744192595.00407
 VIETNAM                   |   1997 | 4687329435.10618
 VIETNAM                   |   1996 | 4703082097.87322
 VIETNAM                   |   1995 | 4692911477.75872
 VIETNAM                   |   1994 | 4719986681.20684
 VIETNAM                   |   1993 | 4693453339.35455
 VIETNAM                   |   1992 | 4698093292.22862
(175 rows)

COMMIT;
COMMIT
